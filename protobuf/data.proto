syntax = "proto3";

package archie;

message Data {
  string architecture = 1;
  int32 end_point = 2;
  string end_reason = 3;
  repeated TbInformation tb_informations = 4;
  repeated TbExecOrder tb_exec_orders = 5;
  repeated MemInfo mem_infos = 6;
  RegisterInfo register_info = 7;
  repeated FaultedData faulted_datas = 8;
  repeated MemDumpInfo mem_dump_infos = 9;
  repeated MemMapInfo mem_map_infos = 10;
}

message TbInformation {
  uint64 base_address = 1;
  uint64 size = 2;
  uint64 instruction_count = 3;
  uint64 num_of_exec = 4;
  string assembler = 5;
}

message TbExecOrder {
  uint64 tb_base_address = 1;
  uint64 pos = 2;
}

message MemInfo {
  uint64 ins_address = 1;
  uint64 size = 2;
  uint64 memmory_address = 3;
  uint32 direction = 4;
  uint64 counter = 5;
}

message MemDumpInfo {
  uint64 address = 1;
  uint64 len = 2;
  repeated MemDump dumps = 3;
}

message MemDump {
  bytes mem = 1;
}

// Type 0 = ARM
// Type 1 = RISCV
message RegisterInfo {
  repeated RegisterDump register_dumps = 1;
  uint32 arch_type = 2;
}

message RegisterDump {
  repeated uint64 register_values = 1;
  uint64 pc = 2;
  uint64 tb_count = 3;
}

message FaultedData {
  uint64 trigger_address = 1;
  string assembler = 2;
}

message MemMapInfo {
  uint64 address = 1;
  uint64 size = 2;
}
